<ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "medium" color = "#ffc000" type = "ball-square-clockwise-spin" [fullScreen] = "true"><p style="color: white" > Loading... </p></ngx-spinner>

<div   class="bgp-background-gray">
    <div style="width: 100%; text-align: right;">
        <!-- <button (click)="SaveReport()" type="submit" class="btn btn-outline-dark my-2 my-sm-0 " > <i class="far fa-save"></i> Save Report</button>
        &nbsp; -->
        <button (click)="DownloadReport()" type="submit" class="btn btn-outline-dark my-2 my-sm-0 " > <i class="far fa-arrow-alt-circle-down"></i> Download Report</button>
    </div>

    <!--test-->

    <div style="width: 100%; margin: auto; text-align: center;">
        <div id=headerDiv style="background-color: rgb(22, 21, 21); text-align: left; margin:0 auto;" >
            <img src="../assets/bgplogo.JPG" style="width:200px;height:150px;">
            <div style="background-color:lightgray; float: right; ">
                <h4><i class="fas fa-map-marker-alt"></i> Company: Black Gold Properties</h4>
                <h4><i class="fas fa-phone-square"></i> Contact Number: +27 (0)72 322 9774</h4>
                <h4><i class="far fa-envelope"></i> Email: info@bgprop.co.za</h4>
            </div>
        </div>

        <br>
         <div >
            <div id="subHeading">
                <h1 >Audit Report</h1>
                <br>
                <h4><i class="fas fa-calendar-alt"></i> Report Date: {{reportDate}}</h4>
                <h4><i class="fas fa-user"></i> Prepared By: {{name}} {{surname}}</h4>
            </div>

            <!-- <div  id="Details" >
                <table class="container" >
                    <tr >
                        <th>Report Date Range:</th>
                        <th></th>
                    </tr>
                    <tr >
                        <td>Start date</td>
                        <td>End Date</td>
                    </tr>
                    <tr >
                        <td>{{startDate}}</td>
                        <td>{{endDate}}</td>
                    </tr>
                </table>
            </div> -->

            <div>
                <table id="table" style="margin: auto; text-align: left;" >
                    <tr>
                        <th colspan="2" class="headingRows" style="color: black; text-align: center;">Audit Details</th>
                    </tr>
                    <tr>
                        <th class="headingRows">Total Sales:</th>
                        <td class="dataRow">{{TotalPropertySales}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Average Sale Price:</th>
                        <td class="dataRow">R{{AverageSalePrice}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Highest Sale Price:</th>
                        <td class="dataRow">R{{MaxSalePrice}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Lowest Sale Price:</th>
                        <td class="dataRow">R{{MinSalePrice}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Total Rentals:</th>
                        <td class="dataRow">{{TotalPropertiesRented}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Average Rental Price:</th>
                        <td class="dataRow">R{{AverageRentalPrice}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Highest Rental Price:</th>
                        <td class="dataRow">R{{MaxRentalPrice}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Lowest Rental Price:</th>
                        <td class="dataRow">R{{MinRentalPrice}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Total Properties:</th>
                        <td class="dataRow">{{PropertyCount}}</td>
                    </tr>
                </table>
            </div>

            <!-- <div class="categoryTable" *ngFor="let property of Properties; let y = index">

                <table id="table{{y}}" style="margin: auto;" >
                    <tr>
                        <th class="headingRows" style="color: black;">Ref:</th>
                        <td class="dataRow">{{property.PROPERTYID}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Address:</th>
                        <td class="dataRow">{{property.PROPERTYADDRESS}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Property Type:</th>
                        <td class="dataRow">{{property.PROPERTYTYPEDESCRIPTION}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Market Type:</th>
                        <td class="dataRow">{{property.MARKETTYPEDESCRIPTION}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Property Owner:</th>
                        <td class="dataRow">{{property.PROPERTYOWNERNAME}} {{property.PROPERTYOWNERSURNAME}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Defects:</th>
                        <td class="dataRow"><p *ngFor="let defect of property.Defects">{{defect[y]?.DEFECTDESCRIPTION}} <span>{{lineBreak}}{{lineBreak}}</span></p></td>
                    </tr>
                    <tr>
                        <th class="headingRows">Points of Interest:</th>
                        <td class="dataRow"><p *ngFor="let pointofinterest of property.PointofInterests">{{pointofinterest.POINTOFINTERESTNAME}} <span>{{lineBreak}}{{lineBreak}}</span></p></td>
                    </tr>
                    <tr>
                        <th class="headingRows">Title Deed:</th>
                        <td class="dataRow">{{this.houses[0].TitleDeed?.PROPERTYDOCUMENT1}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Municipality Report:</th>
                        <td class="dataRow">{{this.houses[0].MunicipalReport?.PROPERTYDOCUMENT1}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Valuation Document:</th>
                        <td class="dataRow">{{this.houses[0].Valuation?.PROPERTYDOCUMENT1}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Lights & Water Report:</th>
                        <td class="dataRow">{{this.houses[0].LightsWater?.PROPERTYDOCUMENT1}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Municipality Valuation and Rates & Taxes:</th>
                        <td class="dataRow">{{this.houses[0].Municipal?.PROPERTYDOCUMENT1}}</td>
                    </tr>
                    <tr>
                        <th class="headingRows">Levies:</th>
                        <td class="dataRow">{{this.houses[0].Levies?.PROPERTYDOCUMENT1}}</td>
                    </tr>
                </table>
            </div> -->
            <br>
            <br>
            
            <h5 style="text-align: center;">***End of Report***</h5> 
        </div>
    </div>
</div>
